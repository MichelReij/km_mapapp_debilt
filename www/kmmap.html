<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <link rel="stylesheet" type="text/css" href="css/leaflet.css" />
        <link rel="stylesheet" type="text/css" href="css/kmmap.css" />
	<script src="js/leaflet.js"></script>
        <script src="js/leaflet-ajax.js"></script>
        <title>Kunstmarkt kaart</title>
    </head>
    <body>
        <div id="map"></div>
    		<script>
		var map = L.map('map').setView([52.10451, 5.17537], 15);
		
		L.tileLayer('http://www.kunstmarktdebilt.nl/km_map/{z}/{x}/{y}.png', {
			minZoom: 15,
			maxZoom: 19,
			attribution: 'Kunstmarkt de Bilt',
			tms: true			
			}).addTo(map);
			
		L.control.scale({imperial: false}).addTo(map);
		/**
		function onEachFeature(feature, layer) {
			var popupContent = "<p>Kunstmarkt de Bilt Kraam " +
					feature.properties.kraamnr + ", test content</p>";

			if (feature.properties) {
				popupContent += feature.properties.naam;
				popupContent +="<br />";
				popupContent += feature.properties.decrip;				
			}

			layer.bindPopup(popupContent);
		}
                

		
		var geoJsonFeatureColl = {
				"type": "FeatureCollection",
                                                              
				"features": [
					{ "type": "Feature", "properties": { "id": 1, "kraamnr": 52, "naam": "kunstenaar 52", "decrip": "maakt 52 kunst" }, "geometry": { "type": "Point", "coordinates": [ 5.174527982723617, 52.104434104019759 ] } },
					{ "type": "Feature", "properties": { "id": 2, "kraamnr": 51, "naam": "kunstenaar 51", "decrip": "maakt 51 kunst" }, "geometry": { "type": "Point", "coordinates": [ 5.174552022448133, 52.104469787971169 ] } },
					{ "type": "Feature", "properties": { "id": 3, "kraamnr": 100, "naam": "kunstenaar 100", "decrip": "maakt 100 kunst" }, "geometry": { "type": "Point", "coordinates": [ 5.175649836534371, 52.104370118931925 ] } }
				]
			}
                **/
               function popUp(f,l){
                    var out = [];
                    var userProp = "";
                    if (f.properties){
                        for(key in f.properties){                         
                            userpropNoPlus = f.properties[key].toString().replace(/\+/g,' ');
                            userProp =decodeURIComponent(userpropNoPlus);                          
                            out.push(key+": "+userProp);
                        }
                        l.bindPopup(out.join("<br />"));
                    }
                }
                
                var geojsonMarkerOptions = {
			radius: 4,
			fillColor: "#ff7800",
			color: "#000",
			weight: 1,
			opacity: 1,
			fillOpacity: 0.8
		};
                
                var geojsonAjaxLayer = new L.GeoJSON.AJAX("km_map_json.php",
                    {   onEachFeature: popUp,
                        pointToLayer: function (feature, latlng) {
			return L.circleMarker(latlng, geojsonMarkerOptions);
			}			
                    });
                 geojsonAjaxLayer.addTo(map);
/**	
		L.geoJson(geoJsonFeatureColl, {
			onEachFeature: onEachFeature,
			pointToLayer: function (feature, latlng) {
			return L.circleMarker(latlng, geojsonMarkerOptions);
			}			
		}).addTo(map);
 **/

		</script>
        
    </body>
</html>
